<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>kabtoffe&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="The personal blog of Toffe Bergström also known online as kabtoffe.">
<meta property="og:type" content="website">
<meta property="og:title" content="kabtoffe&#39;s blog">
<meta property="og:url" content="http://kabtoffe.net/index.html">
<meta property="og:site_name" content="kabtoffe&#39;s blog">
<meta property="og:description" content="The personal blog of Toffe Bergström also known online as kabtoffe.">
<meta property="og:locale">
<meta property="article:author" content="Kristoffer &quot;Toffe&quot; Bergström">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="kabtoffe's blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 8.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">kabtoffe&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://kabtoffe.net"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-ConvertTo-CustomObject-function-as-a-wrapper-for-Select-Object" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/07/12/ConvertTo-CustomObject-function-as-a-wrapper-for-Select-Object/" class="article-date">
  <time class="dt-published" datetime="2017-07-12T12:54:31.000Z" itemprop="datePublished">2017-07-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/07/12/ConvertTo-CustomObject-function-as-a-wrapper-for-Select-Object/">ConvertTo-CustomObject function as a wrapper for Select-Object</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>In <a href="http://kabtoffe.net/2017/07/11/Generate-CSV-from-Dynamics-365-with-Custom-Headers/">yesterday’s post</a> I introduced a custom advanced function for changing property names on objects. I also showed you how to use <code>Select-Object</code> to do the same. Because the <code>Select-Object</code> cmdlet is probably more robust than my little function I decided to try and rewrite the function to use <code>Select-Object</code> under the hood.</p>
<p><code>Select-Object</code> accepts an array of hashtable objects with two key&#x2F;value pairs:</p>
<ul>
<li>N is for the name of the property</li>
<li>E is the expression as a script block that need to be run to get the value</li>
</ul>
<p>In order to use this functionality we need to figure out a way to generate these objects dynamically using our mapping table. The approach I took was to generate the code as strings and then use <code>Invoke-Expression</code>. Since we only need to do this once and not for every object I added a <code>BEGIN</code> block to my function:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">BEGIN &#123;</span><br><span class="line">    $Expression = &quot;&quot;</span><br><span class="line">    $MappingTable.Keys | ForEach-Object &#123;</span><br><span class="line">        $Expression += (</span><br><span class="line">            @&quot;</span><br><span class="line">                @&#123;</span><br><span class="line">                    N=&quot;$($MappingTable[$_])&quot;</span><br><span class="line">                    E=&#123;`$_.$_&#125;</span><br><span class="line">                &#125;,</span><br><span class="line">        &quot;@</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    $Expression = $Expression.Substring(0,$Expression.Length-1)</span><br><span class="line">    $SelectObjectParameter = Invoke-Expression $Expression</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>So for each key in the mapping table we generate a name and an expression to run. Eg. using a mapping table like <code>@{ &quot;name&quot; = &quot;AccountName&quot;; &quot;telephone1&quot; = &quot;Phone&quot;  }</code>generates the following string:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@&#123;</span><br><span class="line">    N=&quot;Phone&quot;</span><br><span class="line">    E=&#123;$_.telephone1&#125;</span><br><span class="line">&#125;,                    @&#123;</span><br><span class="line">    N=&quot;AccountName&quot;</span><br><span class="line">    E=&#123;$_.name&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>That string is exactly what we would feed <code>Select-Object</code>. To get it into actual PowerShell objects we need to feed it to <code>Invoke-Expression</code>. That gives us an array with two separate hashtables each with a N key with a string value and an E key with a script block value.</p>
<p>Once stored in a variable we can use this for each of the objects fed through the pipeline by using it in the <code>PROCESS</code> block of our advanced function:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PROCESS &#123;</span><br><span class="line">        $SourceObject | Select-Object -Property $SelectObjectParameter</span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure>
<p>And that is all there is to it. The function works exactly the same as the ‘quick and dirty’ one in the last post. You can find the full function <a target="_blank" rel="noopener" href="https://github.com/kabtoffe/blog-examples/blob/master/ConvertTo-CustomObject/ConvertTo-CustomObject.ps1">here</a>. Import it to your session and try this example:<br> <code>Get-Process | ConvertTo-CustomObject -MappingTable @{ &quot;ProcessName&quot; = &quot;Name&quot; }</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kabtoffe.net/2017/07/12/ConvertTo-CustomObject-function-as-a-wrapper-for-Select-Object/" data-id="cuidO84czOc2YBUvwLgUvIs5o" data-title="ConvertTo-CustomObject function as a wrapper for Select-Object" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PowerShell/" rel="tag">PowerShell</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Generate-CSV-from-Dynamics-365-with-Custom-Headers" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/07/11/Generate-CSV-from-Dynamics-365-with-Custom-Headers/" class="article-date">
  <time class="dt-published" datetime="2017-07-11T13:39:31.000Z" itemprop="datePublished">2017-07-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/07/11/Generate-CSV-from-Dynamics-365-with-Custom-Headers/">Generate CSV from Dynamics 365 with Custom Headers</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>In my previous <a href="http://kabtoffe.net/2017/07/10/Export-Data-from-Dynamics-365-using-PowerShell/">post</a> we retrieved account records from Dynamics 365 (CRM) and exported those to a CSV-file. In this post we will expand the example with a transformation function to get nicer property names and CSV headers.</p>
<p>The <code>Export-CSV</code> cmdlet exports all the attributes on the objects piped to it. In our last example we used <code>Select-Object</code> to only include the properties we wanted. These properties are still named by the original object. In most cases this is not desirable. You could just replace the CSV file header row, but a cleaner way would be to transform the object somehow. One way to achieve this is to use <code>Select-Object</code> as mentioned <a target="_blank" rel="noopener" href="https://blogs.technet.microsoft.com/heyscriptingguy/2013/10/10/powertip-change-output-object-property-names-with-powershell/">here</a>.</p>
<p>Using our example from before:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(Get-CrmRecords -EntityLogicalName account -Fields &quot;name&quot;,&quot;telephone1&quot;).CrmRecords |</span><br><span class="line">Select-Object @&#123;</span><br><span class="line">        N=&quot;AccountName&quot;</span><br><span class="line">        E=&#123;$_.name&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    @&#123;</span><br><span class="line">        N=&quot;Phonenumber&quot;</span><br><span class="line">        E=&#123;$_.telephone1&#125;</span><br><span class="line">    &#125; |</span><br><span class="line">Export-Csv -Path &quot;accounts.csv&quot;</span><br></pre></td></tr></table></figure>
<p>This is a nice trick and certainly very flexible. You can select any property on the source object and assign it to a new property. But what if you want to parametrize and use a mapping table for the transformation? You could probably cook-up a function that provides a mapping array for <code>Select-Object</code>. But since I only just came up with that and it actually sounds a bit complicated, I propose a different approach.</p>
<p>Let’s create an <a target="_blank" rel="noopener" href="https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.core/about/about_functions_advanced">advanced function</a> to do the heavy lifting for us:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">function ConvertTo-CustomObject&#123;</span><br><span class="line">    [CmdletBinding()]</span><br><span class="line"></span><br><span class="line">    param(</span><br><span class="line">        [Parameter(Mandatory=$True,ValueFromPipeline=$True)]</span><br><span class="line">        $SourceObject,</span><br><span class="line"></span><br><span class="line">        [Parameter(Mandatory=$True)]</span><br><span class="line">        [hashtable]$MappingTable</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    PROCESS &#123;</span><br><span class="line">        $Property = @&#123;&#125;</span><br><span class="line">        $MappingTable.Keys | ForEach-Object &#123;</span><br><span class="line">            $Property.Add(</span><br><span class="line">                $MappingTable[$_],</span><br><span class="line">                $SourceObject.$_</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">        New-Object psobject -Property $Property</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The function <code>ConvertTo-CustomObject</code> accepts objects from the pipeline and a mapping table. It then uses the mapping table to iterate across the the properties we want adding them to a property hashtable. Lastly it creates a new object using the properties and writes it to the output.</p>
<p>So again, using our example, we create a mapping table like so:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$FieldsMappings = @&#123;</span><br><span class="line">    &quot;name&quot; = &quot;AccountName&quot;</span><br><span class="line">    &quot;telephone1&quot; = &quot;Phone&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And then we can replace the <code>Select-Object</code> part with our function:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(Get-CrmRecords -EntityLogicalName account -Fields $FieldsMappings.Keys -AllRows).CrmRecords |</span><br><span class="line">    ConvertTo-CustomObject -MappingTable $FieldsMappings |</span><br><span class="line">    Export-Csv -Path &quot;account.csv&quot;</span><br></pre></td></tr></table></figure>
<p>We retrieve the attributes we want from the system (the keys of the <code>$Fieldmappings</code> hashtable), pipe the objects to our function and write the resulting objects to a CSV like before, but with a nicer header row. Complete code <a target="_blank" rel="noopener" href="https://github.com/kabtoffe/blog-examples/blob/master/Dynamics-365-CSV-Export/Export-Dyn365CSV_2.ps1">here</a>.</p>
<p>While this may seem like a complex way to do it, using objects gets us some nice benefits. Eg. try replacing the <code>Export-CSV</code> line with <code>Out-Gridview</code> and see that happens. If you would like to include more attributes, all you need to is add items to the mapping table.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kabtoffe.net/2017/07/11/Generate-CSV-from-Dynamics-365-with-Custom-Headers/" data-id="cuidZL-8ex0CfU7jc3xvKABxL" data-title="Generate CSV from Dynamics 365 with Custom Headers" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Dynamics-365/" rel="tag">Dynamics 365</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PowerShell/" rel="tag">PowerShell</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Export-Data-from-Dynamics-365-using-PowerShell" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/07/10/Export-Data-from-Dynamics-365-using-PowerShell/" class="article-date">
  <time class="dt-published" datetime="2017-07-10T09:54:30.000Z" itemprop="datePublished">2017-07-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/07/10/Export-Data-from-Dynamics-365-using-PowerShell/">Export Data from Dynamics 365 using PowerShell</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Did you know that you can manage your Dynamics 365 instance using your favorite automation tool PowerShell? The <a target="_blank" rel="noopener" href="https://github.com/seanmcne/Microsoft.Xrm.Data.PowerShell">Microsoft.Xrm.Data.PowerShell-module</a> lets you manage your solutions and such but also has functionality to work on records. In this post I am going to show you how to use the module for data export.</p>
<p>The first thing you need to do is install the module on your system. Just run the command <code>Install-Module Microsoft.Xrm.Data.PowerShell</code> in PowerShell to get it. Next you need to connect to your instance. There are a few alternatives here so please refer to the <a target="_blank" rel="noopener" href="https://github.com/seanmcne/Microsoft.Xrm.Data.PowerShell">project’s GitHub-page</a>. With the Microsoft hosted Dynamics 365 you can use <code>Connect-CrmOnlineDiscovery -InteractiveMode</code>to connect using a GUI.</p>
<h2 id="Working-with-data"><a href="#Working-with-data" class="headerlink" title="Working with data"></a>Working with data</h2><p>Once connected you can try querying for some data. The command <code>Get-CrmRecords -EntityLogicalName account</code> gets you all (or the first 5000) accounts in your system. The output looks something like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Key          Value</span><br><span class="line">---          -----</span><br><span class="line">CrmRecords   &#123;@&#123;accountid=f39551c1-81ff-e611-80f3-5065f38a5a01; accountid_Property=[ac...</span><br><span class="line">Count        349</span><br><span class="line">PagingCookie &lt;cookie page=&quot;1&quot;&gt;&lt;accountid last=&quot;&#123;9AD008BF-8A34-E711-80FA-5065F38BC5C1&#125;&quot;...</span><br><span class="line">NextPage     False</span><br><span class="line">FetchXml         &lt;fetch version=&quot;1.0&quot; output-format=&quot;xml-platform&quot; mapping=&quot;logical&quot; d...</span><br></pre></td></tr></table></figure>

<p>As you can see the result is an object with a few different properties. The CrmRecords property contains the actual result of the query. So if you want to output all the accounts you would run <code>(Get-CrmRecords -EntityLogicalName account).CrmRecords</code>. That gets you something like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">accountid                 : f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">accountid_Property        : [accountid, f39551c1-81ff-e611-80f3-5065f38a5a01]</span><br><span class="line">ReturnProperty_EntityName : account</span><br><span class="line">ReturnProperty_Id         : f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">original                  : &#123;[accountid_Property, [accountid, f39551c1-81ff-e611-80f3-506</span><br><span class="line">                            5f38a5a01]], [accountid, f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">                            ], [ReturnProperty_EntityName, account], [ReturnProperty_Id ,</span><br><span class="line">                             f39551c1-81ff-e611-80f3-5065f38a5a01]&#125;</span><br><span class="line">logicalname               : account</span><br><span class="line"></span><br><span class="line">accountid_Property        : [accountid, b902322e-6005-e711-80f4-5065f38a5a01]</span><br><span class="line">accountid                 : b902322e-6005-e711-80f4-5065f38a5a01</span><br><span class="line">ReturnProperty_EntityName : account</span><br><span class="line">ReturnProperty_Id         : b902322e-6005-e711-80f4-5065f38a5a01</span><br><span class="line">original                  : &#123;[accountid_Property, [accountid, b902322e-6005-e711-80f4-506</span><br><span class="line">                            5f38a5a01]], [accountid, b902322e-6005-e711-80f4-5065f38a5a01</span><br><span class="line">                            ], [ReturnProperty_EntityName, account], [ReturnProperty_Id ,</span><br><span class="line">                             b902322e-6005-e711-80f4-5065f38a5a01]&#125;</span><br><span class="line">logicalname               : account</span><br></pre></td></tr></table></figure>

<p>As you can see there doesn’t seem to be any useful data other than the Id to work with. That’s because we haven’t requested any attributes. To include the account name you need to use the <code>-Fields</code> parameter. Eg. <code>Get-CrmRecords -EntityLogicalName account -Fields &quot;name&quot;</code> includes the account name in the result like so:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">name                      : Test account</span><br><span class="line">name_Property             : [name, Test account]</span><br><span class="line">accountid_Property        : [accountid, f39551c1-81ff-e611-80f3-5065f38a5a01]</span><br><span class="line">accountid                 : f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">ReturnProperty_EntityName : account</span><br><span class="line">ReturnProperty_Id         : f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">original                  : &#123;[name_Property, [name, Test account]], [name, Test</span><br><span class="line">                            account], [accountid_Property, [accountid, f39551c1-81ff</span><br><span class="line">                            -e611-80f3-5065f38a5a01]], [accountid, f39551c1-81ff-e611-80f</span><br><span class="line">                            3-5065f38a5a01]...&#125;</span><br><span class="line">logicalname               : account</span><br></pre></td></tr></table></figure>

<p>So now that we know how to get data from the system, let’s get it into a CSV-file. You can’t quite do a <code>Get-CrmRecords | Export-CSV</code>, but close to it. Here’s a code snippet:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(Get-CrmRecords -EntityLogicalName account -Fields &quot;name&quot;,&quot;telephone1&quot;).CrmRecords |</span><br><span class="line">    Select-Object -Property &quot;name&quot;,&quot;telephone1&quot; |</span><br><span class="line">    Export-Csv -Path &quot;accounts.csv&quot;</span><br></pre></td></tr></table></figure>

<p>The code fetches all accounts from the system, selects just the properties we want and finally exports the result to a CSV-file. You might want to use the <code>-NoTypeInformation</code>, <code>-Delimeter</code> and <code>-Encoding</code> parameters. You can see the final code with some improvements <a target="_blank" rel="noopener" href="https://github.com/kabtoffe/blog-examples/blob/master/Dynamics-365-CSV-Export/Export-Dyn365CSV.ps1">here</a>.</p>
<p>In my next post we will improve on this by supplying our own column names instead of the schema names provided by the system.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kabtoffe.net/2017/07/10/Export-Data-from-Dynamics-365-using-PowerShell/" data-id="cuidQe5a6bL8Icp4akzceohTk" data-title="Export Data from Dynamics 365 using PowerShell" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Dynamics-365/" rel="tag">Dynamics 365</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PowerShell/" rel="tag">PowerShell</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Blog-moved-to-Github-Pages" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/06/11/Blog-moved-to-Github-Pages/" class="article-date">
  <time class="dt-published" datetime="2017-06-11T17:00:28.000Z" itemprop="datePublished">2017-06-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/06/11/Blog-moved-to-Github-Pages/">Blog moved to Github Pages</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Just a quick post to see that the blog publishing still works. I moved the blog from Azure to <a target="_blank" rel="noopener" href="https://pages.github.com/">Github pages</a>. All in all really simple. You just create a repository and publish via git. In my case as I was already using git for publishing all I needed to do was change the git endpoint, add a custom domain and point my DNS to github.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kabtoffe.net/2017/06/11/Blog-moved-to-Github-Pages/" data-id="cuidnK_W8vwbqks10aSzXMZ71" data-title="Blog moved to Github Pages" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-How-this-blog-was-made" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/25/How-this-blog-was-made/" class="article-date">
  <time class="dt-published" datetime="2017-04-25T16:52:13.000Z" itemprop="datePublished">2017-04-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/25/How-this-blog-was-made/">My new shiny Markdown compatible blog</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Markdown"><a href="#Markdown" class="headerlink" title="Markdown"></a>Markdown</h2><p>I remember hearing about Markdown previously but hadn’t paid it much attention. Then I heard it mentioned on a podcast I listen to  I also noticed that the Readme file on Visual Studio Team Services was done in markdown.</p>
<div class="video-container"><iframe src="https://www.youtube.com/embed/_gknWWa2OF0" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p>Naturally I was intrigued. As a <em>wannabe</em> programmer and <em>configuration nazi</em> the idea of using a simple markup syntax to write formatted documents sounded great. I had a brief stint using LaTeX while at school (<em>no one else did though</em>) and while I did do my final year project documentation with it, I quickly lost interest.</p>
<h2 id="The-blog"><a href="#The-blog" class="headerlink" title="The blog"></a>The blog</h2><p>Anyway… I had thought about starting a blog for a while. I use <a target="_blank" rel="noopener" href="https://feedly.com/">Feedly</a> every day and follow lots of blogs. Since I’ve benefited greatly from the community I thought it was time to give something back.</p>
<p>Getting back to the main topic of how this blog came about. I searched for blogging engines that supported Markdown and the first result on Google was <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>. Hexo is a static site generator built using NodeJS. Seemed like a great fit for a backend guy like me.</p>
<p>I installed NodeJS using <a target="_blank" rel="noopener" href="https://chocolatey.org/">Chocolatey</a> and followed <a target="_blank" rel="noopener" href="https://hexo.io/docs/">the instructions</a> to get up and running. Simple enough. The original plan was to host it on an Azure Web App, so I followed <a target="_blank" rel="noopener" href="http://the-coderok.azurewebsites.net/2015/09/16/Running-Hexo-blog-on-Azure/">another set of instructions</a> in order to do that.</p>
<p>Note that in the Azure portal you should use the deployment options instead of continuous integration. That’s where you find the Local Git repo option you need. I first tried the Free plan, but apparently custom domains are not supported on that, so I switched to the Shared plan. See more details <a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/pricing/details/app-service/">here</a>. I’ll probably move the blog to Github pages though since that’s free. Or I could host it on my router…</p>
<p>Once everything was setup all I need to do to update the blog, <em>besides writing the posts</em>, is <code>hexo deploy --generate</code>. I placed the blog source files in Dropbox so I can get to them wherever I am. This post was started on my phone and finished on an iPad. I can’t generate and deploy on the go though. I’m sure PowerShell can help, but that is another blog post I think. I’m thinking some kind of change monitoring and automated deployment.</p>
<p>Please note that I’m using this blog as another learning opportunity, so except changes, downtime etc. I’m also not sure how I active I’m actually going to be.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kabtoffe.net/2017/04/25/How-this-blog-was-made/" data-id="cuidrBkVRD2HHsRTMYF8fmDrw" data-title="My new shiny Markdown compatible blog" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NodeJS/" rel="tag">NodeJS</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Dynamics-365-Document-Template-from-existing-Word-Document" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/23/Dynamics-365-Document-Template-from-existing-Word-Document/" class="article-date">
  <time class="dt-published" datetime="2017-04-23T13:16:31.000Z" itemprop="datePublished">2017-04-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/23/Dynamics-365-Document-Template-from-existing-Word-Document/">Dynamics 365 Document Template from Existing Word Document</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>For the impatient this is how you do it:</p>
<blockquote>
<p>Extract the Dynamics 365 generated template from zip and add the CustomXML-part to your existing template.</p>
</blockquote>
<p>I couldn’t find a post on how to create a new Dynamics 365 Document Template using an existing document or template. I’m sure many organisations have an existing template with all the right formatting, headers and footers they would like to use.</p>
<p>Knowing how .docx-files are structured and how Dynamics 365 stores the metadata it was easy enough to figure out. I thought I would share how with you.</p>
<h3 id="Step-by-step"><a href="#Step-by-step" class="headerlink" title="Step by step"></a>Step by step</h3><ol>
<li>Create a new blank template from Dynamics 365 <a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/dynamics/crm-customer-center/using-word-templates-in-dynamics-365.aspx">the way you would normally do it</a> and save the file to your computer</li>
<li>Change the extension of the file to .zip and extract it</li>
<li>Open the existing document you would like to use with Dynamics 365</li>
<li>In your Word template click Developer &gt; XML Mapping Pane<br><img src="https://www.microsoft.com/en-us/dynamics/crm-customer-center/crm_ITPro_WordTemplateSelectXMLMapping.png" alt="XML mapping pane"></li>
<li>In the drop down menu select (Add new part…)<br><img src="https://www.microsoft.com/en-us/dynamics/crm-customer-center/crm_ITPro_WordTemplateXMLMappingDefault.png" alt="Dropdown menu"></li>
<li>Navigate to your extracted template and select the xml-file (item.xml) under the CustomXML-directory</li>
<li>Proceed as you normally would with a blank template</li>
</ol>
<p>Note that this is <em>might not be supported</em>, but seems to work just fine.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kabtoffe.net/2017/04/23/Dynamics-365-Document-Template-from-existing-Word-Document/" data-id="cuid-KbVRJyeKIkvrRZQclKJn" data-title="Dynamics 365 Document Template from Existing Word Document" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Dynamics-365/" rel="tag">Dynamics 365</a></li></ul>

    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dynamics-365/" rel="tag">Dynamics 365</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NodeJS/" rel="tag">NodeJS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PowerShell/" rel="tag">PowerShell</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Dynamics-365/" style="font-size: 20px;">Dynamics 365</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/NodeJS/" style="font-size: 10px;">NodeJS</a> <a href="/tags/PowerShell/" style="font-size: 20px;">PowerShell</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/07/12/ConvertTo-CustomObject-function-as-a-wrapper-for-Select-Object/">ConvertTo-CustomObject function as a wrapper for Select-Object</a>
          </li>
        
          <li>
            <a href="/2017/07/11/Generate-CSV-from-Dynamics-365-with-Custom-Headers/">Generate CSV from Dynamics 365 with Custom Headers</a>
          </li>
        
          <li>
            <a href="/2017/07/10/Export-Data-from-Dynamics-365-using-PowerShell/">Export Data from Dynamics 365 using PowerShell</a>
          </li>
        
          <li>
            <a href="/2017/06/11/Blog-moved-to-Github-Pages/">Blog moved to Github Pages</a>
          </li>
        
          <li>
            <a href="/2017/04/25/How-this-blog-was-made/">My new shiny Markdown compatible blog</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2026 Kristoffer &#34;Toffe&#34; Bergström<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>