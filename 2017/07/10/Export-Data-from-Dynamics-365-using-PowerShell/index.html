<!DOCTYPE html>
<html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="description" content="The personal blog of Toffe Bergström also known online as kabtoffe.">



<title>Export Data from Dynamics 365 using PowerShell | kabtoffe&#39;s blog</title>
<link rel="canonical" href="http://kabtoffe.net/2017/07/10/Export-Data-from-Dynamics-365-using-PowerShell/">
<meta name="robots" content="index, follow">
<meta name="author" content="Kristoffer Bergström">
<meta name="generator" content="Hexo ">
<meta name="theme-color" content="#8B4513">

<meta property="og:type" content="website">
<meta property="og:title" content="Export Data from Dynamics 365 using PowerShell">

  <meta property="og:description" content="The personal blog of Toffe Bergström also known online as kabtoffe.">

<meta property="og:url" content="http://kabtoffe.net/2017/07/10/Export-Data-from-Dynamics-365-using-PowerShell/">
<meta property="og:image" content="/images/header-background.jpeg">
<meta property="og:site_name" content="kabtoffe&#39;s blog">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@kabtoffe">


<link rel="alternate" type="application/atom+xml" title="kabtoffe&#39;s blog" href="/atom.xml">



<link rel="stylesheet" href="/css/style.css">


<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div class="header-inner">
    <div class="site-title">
      <h1 class="logo">
        <a href="/">
          <span class="bracket">[</span>kabtoffe's blog<span class="bracket">]</span>
        </a>
      </h1>
    </div>
    
    <nav id="main-nav">
      
        <a class="main-nav-link" href="/">Home</a>
      
        <a class="main-nav-link" href="/archives">Archives</a>
      
        <a class="main-nav-link" href="/About-Me/">About</a>
      
      
        <a class="main-nav-link rss-link" href="/atom.xml" title="RSS Feed">RSS</a>
      
    </nav>
  </div>
</header>

      <div class="outer">
        <section id="main"><div class="article-meta">
  <a href="/2017/07/10/Export-Data-from-Dynamics-365-using-PowerShell/" class="article-date">
  <time class="dt-published" datetime="2017-07-10T09:54:30.000Z" itemprop="datePublished">⏰ 2017-07-10</time>
</a>

  

</div>

  <header class="article-header">
    
  
    <h1 class="p-name article-title" itemprop="headline name">
      Export Data from Dynamics 365 using PowerShell
    </h1>
  


  </header>

<div class="e-content" itemprop="articleBody">
  
    <p>Did you know that you can manage your Dynamics 365 instance using your favorite automation tool PowerShell? The <a target="_blank" rel="noopener" href="https://github.com/seanmcne/Microsoft.Xrm.Data.PowerShell">Microsoft.Xrm.Data.PowerShell-module</a> lets you manage your solutions and such but also has functionality to work on records. In this post I am going to show you how to use the module for data export.</p>
<p>The first thing you need to do is install the module on your system. Just run the command <code>Install-Module Microsoft.Xrm.Data.PowerShell</code> in PowerShell to get it. Next you need to connect to your instance. There are a few alternatives here so please refer to the <a target="_blank" rel="noopener" href="https://github.com/seanmcne/Microsoft.Xrm.Data.PowerShell">project’s GitHub-page</a>. With the Microsoft hosted Dynamics 365 you can use <code>Connect-CrmOnlineDiscovery -InteractiveMode</code>to connect using a GUI.</p>
<h2 id="Working-with-data"><a href="#Working-with-data" class="headerlink" title="Working with data"></a>Working with data</h2><p>Once connected you can try querying for some data. The command <code>Get-CrmRecords -EntityLogicalName account</code> gets you all (or the first 5000) accounts in your system. The output looks something like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Key          Value</span><br><span class="line">---          -----</span><br><span class="line">CrmRecords   &#123;@&#123;accountid=f39551c1-81ff-e611-80f3-5065f38a5a01; accountid_Property=[ac...</span><br><span class="line">Count        349</span><br><span class="line">PagingCookie &lt;cookie page=&quot;1&quot;&gt;&lt;accountid last=&quot;&#123;9AD008BF-8A34-E711-80FA-5065F38BC5C1&#125;&quot;...</span><br><span class="line">NextPage     False</span><br><span class="line">FetchXml         &lt;fetch version=&quot;1.0&quot; output-format=&quot;xml-platform&quot; mapping=&quot;logical&quot; d...</span><br></pre></td></tr></table></figure>

<p>As you can see the result is an object with a few different properties. The CrmRecords property contains the actual result of the query. So if you want to output all the accounts you would run <code>(Get-CrmRecords -EntityLogicalName account).CrmRecords</code>. That gets you something like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">accountid                 : f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">accountid_Property        : [accountid, f39551c1-81ff-e611-80f3-5065f38a5a01]</span><br><span class="line">ReturnProperty_EntityName : account</span><br><span class="line">ReturnProperty_Id         : f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">original                  : &#123;[accountid_Property, [accountid, f39551c1-81ff-e611-80f3-506</span><br><span class="line">                            5f38a5a01]], [accountid, f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">                            ], [ReturnProperty_EntityName, account], [ReturnProperty_Id ,</span><br><span class="line">                             f39551c1-81ff-e611-80f3-5065f38a5a01]&#125;</span><br><span class="line">logicalname               : account</span><br><span class="line"></span><br><span class="line">accountid_Property        : [accountid, b902322e-6005-e711-80f4-5065f38a5a01]</span><br><span class="line">accountid                 : b902322e-6005-e711-80f4-5065f38a5a01</span><br><span class="line">ReturnProperty_EntityName : account</span><br><span class="line">ReturnProperty_Id         : b902322e-6005-e711-80f4-5065f38a5a01</span><br><span class="line">original                  : &#123;[accountid_Property, [accountid, b902322e-6005-e711-80f4-506</span><br><span class="line">                            5f38a5a01]], [accountid, b902322e-6005-e711-80f4-5065f38a5a01</span><br><span class="line">                            ], [ReturnProperty_EntityName, account], [ReturnProperty_Id ,</span><br><span class="line">                             b902322e-6005-e711-80f4-5065f38a5a01]&#125;</span><br><span class="line">logicalname               : account</span><br></pre></td></tr></table></figure>

<p>As you can see there doesn’t seem to be any useful data other than the Id to work with. That’s because we haven’t requested any attributes. To include the account name you need to use the <code>-Fields</code> parameter. Eg. <code>Get-CrmRecords -EntityLogicalName account -Fields &quot;name&quot;</code> includes the account name in the result like so:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">name                      : Test account</span><br><span class="line">name_Property             : [name, Test account]</span><br><span class="line">accountid_Property        : [accountid, f39551c1-81ff-e611-80f3-5065f38a5a01]</span><br><span class="line">accountid                 : f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">ReturnProperty_EntityName : account</span><br><span class="line">ReturnProperty_Id         : f39551c1-81ff-e611-80f3-5065f38a5a01</span><br><span class="line">original                  : &#123;[name_Property, [name, Test account]], [name, Test</span><br><span class="line">                            account], [accountid_Property, [accountid, f39551c1-81ff</span><br><span class="line">                            -e611-80f3-5065f38a5a01]], [accountid, f39551c1-81ff-e611-80f</span><br><span class="line">                            3-5065f38a5a01]...&#125;</span><br><span class="line">logicalname               : account</span><br></pre></td></tr></table></figure>

<p>So now that we know how to get data from the system, let’s get it into a CSV-file. You can’t quite do a <code>Get-CrmRecords | Export-CSV</code>, but close to it. Here’s a code snippet:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(Get-CrmRecords -EntityLogicalName account -Fields &quot;name&quot;,&quot;telephone1&quot;).CrmRecords |</span><br><span class="line">    Select-Object -Property &quot;name&quot;,&quot;telephone1&quot; |</span><br><span class="line">    Export-Csv -Path &quot;accounts.csv&quot;</span><br></pre></td></tr></table></figure>

<p>The code fetches all accounts from the system, selects just the properties we want and finally exports the result to a CSV-file. You might want to use the <code>-NoTypeInformation</code>, <code>-Delimeter</code> and <code>-Encoding</code> parameters. You can see the final code with some improvements <a target="_blank" rel="noopener" href="https://github.com/kabtoffe/blog-examples/blob/master/Dynamics-365-CSV-Export/Export-Dyn365CSV.ps1">here</a>.</p>
<p>In my next post we will improve on this by supplying our own column names instead of the schema names provided by the system.</p>

  
</div>
<footer class="article-footer">
  
  <div class="post-tags">
    
      <a class="tag-link" href="/tags/PowerShell/">#PowerShell</a>
    
      <a class="tag-link" href="/tags/Dynamics-365/">#Dynamics 365</a>
    
  </div>


</footer>

  
<nav id="article-nav">
  
    <a href="/2017/07/11/Generate-CSV-from-Dynamics-365-with-Custom-Headers/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">← Newer</strong>
      <div class="article-nav-title">
        
          Generate CSV from Dynamics 365 with Custom Headers
        
      </div>
    </a>
  
  
    <a href="/2017/06/11/Blog-moved-to-Github-Pages/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older →</strong>
      <div class="article-nav-title">Blog moved to Github Pages</div>
    </a>
  
</nav>




</section>
        
          <aside id="sidebar">
  <div class="sidebar-inner">
    
    <section class="widget">
      <h3 class="widget-title">Recent Posts</h3>
      <ul class="widget-list">
        
          <li><a href="/2026/02/12/codemanship-an-ode-to-it-cant-be-done/">Quoting codemanship - An Ode To “It Can’t Be Done”</a></li>
        
          <li><a href="/2026/02/11/neeraj-nandwana-generally-available-host-and-run-code-apps-in-power-apps/">Quoting Neeraj Nandwana - Generally available: host and run code apps in Power Apps</a></li>
        
          <li><a href="/2026/02/11/neeraj-nandwana-announcing-general-availability-ga-of-building-single-page-applications-for-power-pages/">Quoting Neeraj Nandwana - Announcing General Availability (GA) of building single-page applications for Power Pages</a></li>
        
          <li><a href="/2026/02/07/Automating-Quote-Posts-with-Feedly-and-Hexo/">Automating Quote Post Creation with Feedly and Hexo</a></li>
        
          <li><a href="/2026/02/07/ben-thompson-microsoft-and-software-survival/">Quoting Ben Thompson - Microsoft and Software Survival</a></li>
        
      </ul>
    </section>
    
    <section class="widget">
      <h3 class="widget-title">Archives</h3>
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2026/02/">February 2026</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">2</span></li></ul>
    </section>
    
    <section class="widget">
      <h3 class="widget-title">Tags</h3>
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/" rel="tag">AI</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI-Coding/" rel="tag">AI Coding</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Automation/" rel="tag">Automation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bookmarklet/" rel="tag">Bookmarklet</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dynamics-365/" rel="tag">Dynamics 365</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Feedly/" rel="tag">Feedly</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NodeJS/" rel="tag">NodeJS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Power-Apps/" rel="tag">Power Apps</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Power-Platform/" rel="tag">Power Platform</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PowerShell/" rel="tag">PowerShell</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Quote/" rel="tag">Quote</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Software-Development/" rel="tag">Software Development</a><span class="tag-list-count">1</span></li></ul>
    </section>
  </div>
</aside>

        
      </div>
      <footer id="footer">
  <p class="footer-text">
    &copy; 2026 Kristoffer &#34;Toffe&#34; Bergström · Powered by <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a>
  </p>
  <div class="footer-gears">
    <span>⚙️</span><span>⚙️</span><span>⚙️</span>
  </div>
</footer>

    </div>
    <!-- Analytics -->

  </div>
</body>
</html>
